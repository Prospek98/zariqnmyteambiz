<!doctype html>
<html lang="ms">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Tempah Servis</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-800">
<div class="max-w-xl mx-auto p-4">
<h1 class="text-2xl font-semibold mb-3">Tempah Servis Bengkel</h1>
<div class="bg-white rounded-2xl p-5 shadow">
<input id="name" class="border rounded-xl px-3 py-2 w-full mb-2" placeholder="Nama"/>
<input id="phone" class="border rounded-xl px-3 py-2 w-full mb-2" placeholder="Telefon"/>
<input id="listing_id" class="border rounded-xl px-3 py-2 w-full mb-2" placeholder="ID Listing (jika berkaitan)"/>
<select id="workshop" class="border rounded-xl px-3 py-2 w-full mb-2"></select>
<input id="date_time" type="datetime-local" class="border rounded-xl px-3 py-2 w-full mb-3"/>
<button id="btn" class="bg-indigo-600 text-white rounded-xl px-4 py-2">Tempah</button>
<div id="msg" class="text-sm mt-3"></div>
</div>
</div>
<script>
const WEB_APP_URL='https://script.google.com/macros/s/AKfycbxmz1In-BjFP0dGspnYVRRbqJzuTmpxYfKflq4LLzQKU9dGxvtOgTROcxQ9p80oTVA/exec';
async function loadWorkshops(){
const r=await fetch(`${WEB_APP_URL}?path=workshops`); const j=await r.json();
workshop.innerHTML = (j.data||[]).map(w=>`<option value='${w.name}'>${w.name} – ${w.district}</option>`).join('') || `<option>Johor Bahru – Pusat Servis</option>`;
}
btn.onclick=async()=>{
const payload={ type:'service', listing_id:listing_id.value, workshop:workshop.value, name:name.value, phone:phone.value, date_time:date_time.value };
const r=await fetch(WEB_APP_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({action:'add_booking',payload})});
const j=await r.json(); msg.textContent = j.ok? 'Tempahan dihantar. Kami akan sahkan secepatnya.' : ('Ralat: '+j.error);
};
loadWorkshops();
</script>
</body>
</html>
